#!/bin/bash

function log {
    echo "> ${@}"
}

log "generating proto shizzles"
protoc --proto_path=./ -I../golpje/ --go_out=plugins=grpc:golpje/ golpje.proto

log "updating dependencies"
go get -d .
log "building"
mkdir -p dist
go build -o dist/golpje *.go
if [[ $? -ne 0 ]]; then
   echo "Build failed, stopping now"
fi

log "starting"
echo '---------------------------------'
echo
dist/golpje ${@}
